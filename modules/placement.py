import random
def grid_sample_no_overlap(x_range, y_range, N, min_gap, used):
    x0, x1 = x_range
    y0, y1 = y_range

    # min_gap 간격으로 후보 만들기
    xs_cand = list(range(x0, x1+1, min_gap))
    ys_cand = list(range(y0, y1+1, min_gap))

    # 전역 used를 제외한 그리드
    grid = [(x, y)
            for x in xs_cand
            for y in ys_cand
            if (x, y) not in used]
    
    if len(grid) < N:
        raise ValueError(f"후보가 부족합니다: {len(grid)} available < required {N}")

    # ③ 랜덤 샘플링
    chosen = random.sample(grid, N)

    # ④ used에 추가
    for pt in chosen:
        used.add(pt)

    return [[x, y, 0] for x, y in chosen]


# PLACEMENT = {
#     'blue':{ # x, y, color
#         '74전차대대_1중대':{
#             # x_range, y_range
#             'loc':[[380, 400], [400, 500]], 
#             'comp':{
#                 "Sho't_Kal":25,
#             },
#             'phase': 'P1'
#         },
#         '75기계화보병대대_1중대':{
#             'loc': [[350, 380], [400, 435]], 
#             'comp': {
#                 "M113": 10,
#                 "M72_LAW":6
#                 },
#             'phase': 'P1'
#         },
#         '179야포대대_박격포중대':{
#             'loc': [[360, 380], [480, 500]], 
#             'comp': {
#                 "60mm_Mortar": 3
#                 },
#             'phase': 'P1'
#         },
#         '179야포대대_105mm견인포1중대':{
#             'loc': [[375, 380], [460, 500]], 
#             'comp': {
#                 "105mm_Howitzer": 3
#                 },
#             'phase': 'P1'
#         },
#         '74전차대대_2중대':{
#             'loc': [[250, 275], [180, 240]], 
#             'comp': {
#                 "Sho't_Kal":5
#                 },
#                 'phase': 'P1'
#         },
#         '179야포대대_105mm견인포2중대':{
#             'loc': [[265, 270], [190, 220]], 
#             'comp': {
#                 "105mm_Howitzer": 3
#                 },
#                 'phase': 'P1'
#         },
#         '53전차대대_1중대':{
#             'loc': [[100, 120], [330, 380]], 
#             'dest': [[350, 370], [480, 510]],        
#             'comp': {
#                 "Sho't_Kal":10
#                 },
#             'phase': 'P2'
#             }
#     },
#     'red':{
#         '85보병여단_1보병대대_1중대': {
#             'loc': [[650, 700], [420, 450]], 
#             'dest':[[350, 410], [400, 500]],
#             'comp':{
#                 # "AK-47":90,
#                 "RPG-7":6,
#                 "107mm_B-11_Recoilless_Rifle":1
#                 }, # 80 50
#             'phase': 'P1-1'
#         },
#         '85보병여단_2보병대대_4중대': {
#             'loc': [[700, 750], [350, 420]], 
#             'dest':[[350, 410], [400, 500]],
#             'comp': {
#                 # "AK-47":90,
#                 "RPG-7":6,
#                 "107mm_B-11_Recoilless_Rifle":1
#                 },
#                 'phase': 'P1-1'
#         },
#         '121기계화보병여단_전차중대': {
#             'loc': [[620, 670], [350, 400]], 
#             'dest':[[350, 410], [400, 500]],
#             'comp': {
#                 "T-55": 10,
#             }, # 80 50
#         'phase': 'P1-1'
#         },
#         '82기갑여단_5전차대대': {
#             'loc': [[620, 670], [440, 520]], 
#             'dest':[[350, 410], [400, 500]],
#             'comp': {
#                 "T-55":50,  
#             }, # 80 50
#             'phase': 'P2-1'
#         },
#         '82기갑여단_기보중대':  {
#             'loc': [[680, 770], [440, 480]], 
#             'dest':[[350, 410], [400, 500]],
#             'comp': {
#                 "BMP-1":10,
#                 "RPG-7": 10
#                 }, # 80 50
#             'phase': 'P2-2'
#         },
#         '82기갑여단_6전차대대': {
#             'loc': [[650, 680], [300, 350]], 
#             'dest':[[350, 410], [400, 500]],
#             'comp': {
#                 "T-55":10
#                 },
#             'phase': 'P3'
#         },
#         '78기갑여단_1전차대대': {
#             'loc': [[650, 700], [300, 370]], 
#             'dest':[[350, 410], [400, 500]],
#             'comp': {
#                 "T-55":40
#                 },
#             'phase': 'P3'
#         },
#         '81기갑여단_7전차대대': {
#             'loc': [[720, 750], [300, 350]], 
#             'dest':[[350, 410], [400, 500]],
#             'comp': {
#                 "T-62":40,
#             }, 
#             'phase': 'P4'
#         },
#         '121기계화보병여단_3기보대대': {
#             'loc': [[750, 790], [350, 470]], 
#             'dest':[[350, 410], [400, 500]],
#             'comp': {
#                 "BMP-1": 40,
#                 "9M14_Malyutka": 3,
#                 "RPG-7": 40
#                 },
#             'phase': 'P4' # 80 50
#         }
#     }
# }


PLACEMENT = {
    'blue':{ # x, y, color
        '74전차대대_1중대':{
            # x_range, y_range
            'loc':[[390, 400], [350, 455]], 
            'comp':{
                "Sho't_Kal":25,
            },
            'phase': 'P1-1'
        },
        '75기계화보병대대_1중대':{
            'loc': [[380, 390], [350, 435]], 
            'comp': {
                "M113": 10,
                "M72_LAW":6
                },
            'phase': 'P1-1'
        },
        '179야포대대_박격포중대':{
            'loc': [[360, 380], [410, 425]], 
            'comp': {
                "60mm_Mortar": 3
                },
            'phase': 'P1-2'
        },
        '179야포대대_105mm견인포1중대':{
            'loc': [[375, 380], [390, 425]], 
            'comp': {
                "105mm_Howitzer": 4
                },
            'phase': 'P1-2'
        },
        '74전차대대_2중대':{
            'loc': [[270, 275], [200, 240]], 
            'comp': {
                "Sho't_Kal":5
                },
                'phase': 'P1-2'
        },
        '179야포대대_105mm견인포2중대':{
            'loc': [[265, 270], [190, 220]], 
            'comp': {
                "105mm_Howitzer": 2
                },
                'phase': 'P1-2'
        },
        '53전차대대_1중대':{
            'loc': [[100, 120], [330, 380]], 
            'dest': [[350, 370], [480, 510]],        
            'comp': {
                "Sho't_Kal":10
                },
            'phase': 'P2'
            }
    },
    'red':{
        # ===== P1-1 단계: 초기 교량 돌파 시도 =====
        '121기계화보병여단_전차중대': {
            'loc': [[620, 670], [400, 470]], 
            'dest': [[350, 400], [380, 420]],  # 중앙 돌파
            'comp': {
                "T-55": 10,
            },
        'phase': 'P1-1'
        },
        '85보병여단_1보병대대_1중대': {
            'loc': [[650, 700], [400, 470]], 
            'dest': [[400, 450], [420, 450]],  # 블루 주력 근처로 진격
            'comp':{
                "RPG-7":6,
                "107mm_B-11_Recoilless_Rifle":1
                },
            'phase': 'P1-1'
        },
        '85보병여단_2보병대대_4중대': {
            'loc': [[620, 670], [400, 470]], 
            'dest': [[450, 500], [350, 400]],  # 남쪽에서 우회 공격
            'comp': {
                "RPG-7":6,
                "107mm_B-11_Recoilless_Rifle":1
                },
                'phase': 'P1-1'
        },
        
        # ===== P2-1, P2-2 단계: 모로코 여단 주공격 =====
        '82기갑여단_5전차대대': {
            'loc': [[620, 670], [430, 480]], 
            'dest': [[300, 350], [440, 480]],  # 북쪽 우회 대규모 기갑 공격
            'comp': {
                "T-55":50,  
            },
            'phase': 'P2-1'
        },
        '82기갑여단_기보중대':  {
            'loc': [[600, 700], [430, 480]], 
            'dest': [[350, 400], [460, 500]],  # 기갑 지원
            'comp': {
                "BMP-1":10,
                "RPG-7": 10
                },
            'phase': 'P2-2'
        },
        
        # ===== P3 단계: 야간 기갑 동시 투입 =====
        '82기갑여단_6전차대대': {
            'loc': [[650, 680], [350, 400]], 
            'dest': [[250, 300], [280, 320]],  # 남쪽 측면 공격
            'comp': {
                "T-55":10
                },
            'phase': 'P3'
        },
        '78기갑여단_1전차대대': {
            'loc': [[650, 700], [350, 420]], 
            'dest': [[200, 250], [300, 350]],  # 남서쪽 깊숙이 침투
            'comp': {
                "T-55":40
                },
            'phase': 'P3'
        },
        
        # ===== P4 단계: 최종 예비 투입 =====
        '81기갑여단_7전차대대': {
            'loc': [[650, 700], [300, 400]], 
            'dest': [[150, 200], [250, 300]],  # 최후방 기습
            'comp': {
                "T-62":40,
            }, 
            'phase': 'P4'
        },
        '121기계화보병여단_3기보대대': {
            'loc': [[650, 700], [300, 430]], 
            'dest': [[200, 250], [400, 450]],  # 중앙 종심 돌파
            'comp': {
                "BMP-1": 40,
                "9M14_Malyutka": 3,
                "RPG-7": 40
                },
            'phase': 'P4'
        }
    }
}

# 전술적 설명
TACTICAL_CONCEPT = {
    'red_strategy': {
        'P1-1': "초기 교량 돌파 시도 - 소규모 보병/전차로 블루 방어선 테스트",
        'P2-1': "모로코 여단 주공격 - 북쪽으로 대규모 기갑부대 우회 진격", 
        'P2-2': "기계화보병 지원 - 주공격 지원 및 중앙 압박",
        'P3': "야간 동시 투입 - 남쪽 측면에서 2개 전차대대 동시 공격",
        'P4': "최종 예비 투입 - 깊숙한 후방 침투로 블루 붕괴 유도"
    },
    'blue_response': {
        'P1': "초기 방어 배치 - 주요 지점 고수",
        'P2': "예비 투입 - 53전차대대가 위기 지역 지원"
    }
}

# print("=== 레드팀 공격 계획 ===")
# for phase, description in TACTICAL_CONCEPT['red_strategy'].items():
#     print(f"{phase}: {description}")

# print("\n=== 블루팀 방어 계획 ===") 
# for phase, description in TACTICAL_CONCEPT['blue_response'].items():
#     print(f"{phase}: {description}")