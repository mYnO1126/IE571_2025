import random
def grid_sample_no_overlap(x_range, y_range, N, min_gap, used):
    x0, x1 = x_range
    y0, y1 = y_range

    # min_gap 간격으로 후보 만들기
    xs_cand = list(range(x0, x1+1, min_gap))
    ys_cand = list(range(y0, y1+1, min_gap))

    # 전역 used를 제외한 그리드
    grid = [(x, y)
            for x in xs_cand
            for y in ys_cand
            if (x, y) not in used]
    
    if len(grid) < N:
        raise ValueError(f"후보가 부족합니다: {len(grid)} available < required {N}")

    # ③ 랜덤 샘플링
    chosen = random.sample(grid, N)

    # ④ used에 추가
    for pt in chosen:
        used.add(pt)

    return [[x, y, 0] for x, y in chosen]


# PLACEMENT = {
#     'blue':{ # x, y, color
#         '74전차대대_1중대':{
#             # x_range, y_range
#             'loc':[[380, 400], [400, 500]], 
#             'comp':{
#                 "Sho't_Kal":25,
#             },
#             'phase': 'P1'
#         },
#         '75기계화보병대대_1중대':{
#             'loc': [[350, 380], [400, 435]], 
#             'comp': {
#                 "M113": 10,
#                 "M72_LAW":6
#                 },
#             'phase': 'P1'
#         },
#         '179야포대대_박격포중대':{
#             'loc': [[360, 380], [480, 500]], 
#             'comp': {
#                 "60mm_Mortar": 3
#                 },
#             'phase': 'P1'
#         },
#         '179야포대대_105mm견인포1중대':{
#             'loc': [[375, 380], [460, 500]], 
#             'comp': {
#                 "105mm_Howitzer": 3
#                 },
#             'phase': 'P1'
#         },
#         '74전차대대_2중대':{
#             'loc': [[250, 275], [180, 240]], 
#             'comp': {
#                 "Sho't_Kal":5
#                 },
#                 'phase': 'P1'
#         },
#         '179야포대대_105mm견인포2중대':{
#             'loc': [[265, 270], [190, 220]], 
#             'comp': {
#                 "105mm_Howitzer": 3
#                 },
#                 'phase': 'P1'
#         },
#         '53전차대대_1중대':{
#             'loc': [[100, 120], [330, 380]], 
#             'dest': [[350, 370], [480, 510]],        
#             'comp': {
#                 "Sho't_Kal":10
#                 },
#             'phase': 'P2'
#             }
#     },
#     'red':{
#         '85보병여단_1보병대대_1중대': {
#             'loc': [[650, 700], [420, 450]], 
#             'dest':[[350, 410], [400, 500]],
#             'comp':{
#                 # "AK-47":90,
#                 "RPG-7":6,
#                 "107mm_B-11_Recoilless_Rifle":1
#                 }, # 80 50
#             'phase': 'P1-1'
#         },
#         '85보병여단_2보병대대_4중대': {
#             'loc': [[700, 750], [350, 420]], 
#             'dest':[[350, 410], [400, 500]],
#             'comp': {
#                 # "AK-47":90,
#                 "RPG-7":6,
#                 "107mm_B-11_Recoilless_Rifle":1
#                 },
#                 'phase': 'P1-1'
#         },
#         '121기계화보병여단_전차중대': {
#             'loc': [[620, 670], [350, 400]], 
#             'dest':[[350, 410], [400, 500]],
#             'comp': {
#                 "T-55": 10,
#             }, # 80 50
#         'phase': 'P1-1'
#         },
#         '82기갑여단_5전차대대': {
#             'loc': [[620, 670], [440, 520]], 
#             'dest':[[350, 410], [400, 500]],
#             'comp': {
#                 "T-55":50,  
#             }, # 80 50
#             'phase': 'P2-1'
#         },
#         '82기갑여단_기보중대':  {
#             'loc': [[680, 770], [440, 480]], 
#             'dest':[[350, 410], [400, 500]],
#             'comp': {
#                 "BMP-1":10,
#                 "RPG-7": 10
#                 }, # 80 50
#             'phase': 'P2-2'
#         },
#         '82기갑여단_6전차대대': {
#             'loc': [[650, 680], [300, 350]], 
#             'dest':[[350, 410], [400, 500]],
#             'comp': {
#                 "T-55":10
#                 },
#             'phase': 'P3'
#         },
#         '78기갑여단_1전차대대': {
#             'loc': [[650, 700], [300, 370]], 
#             'dest':[[350, 410], [400, 500]],
#             'comp': {
#                 "T-55":40
#                 },
#             'phase': 'P3'
#         },
#         '81기갑여단_7전차대대': {
#             'loc': [[720, 750], [300, 350]], 
#             'dest':[[350, 410], [400, 500]],
#             'comp': {
#                 "T-62":40,
#             }, 
#             'phase': 'P4'
#         },
#         '121기계화보병여단_3기보대대': {
#             'loc': [[750, 790], [350, 470]], 
#             'dest':[[350, 410], [400, 500]],
#             'comp': {
#                 "BMP-1": 40,
#                 "9M14_Malyutka": 3,
#                 "RPG-7": 40
#                 },
#             'phase': 'P4' # 80 50
#         }
#     }
# }


PLACEMENT = {
    'blue':{ # x, y, color
        '74전차대대_1중대':{
            # x_range, y_range
            'loc':[[390, 400], [350, 455]], 
            'comp':{
                "Sho't_Kal":25,
            },
            'phase': 'P1-1'
        },
        '75기계화보병대대_1중대':{
            'loc': [[380, 390], [350, 435]], 
            'comp': {
                "M113": 10,
                "M72_LAW":6
                },
            'phase': 'P1-1'
        },
        '179야포대대_박격포중대':{
            'loc': [[360, 380], [410, 425]], 
            'comp': {
                "60mm_Mortar": 3
                },
            'phase': 'P1-1'
        },
        '179야포대대_105mm견인포1중대':{
            'loc': [[375, 380], [390, 425]], 
            'comp': {
                "105mm_Howitzer": 4
                },
            'phase': 'P1-1'
        },
        '74전차대대_2중대':{
            'loc': [[270, 275], [200, 240]], 
            'comp': {
                "Sho't_Kal":5
                },
                'phase': 'P1-1'
        },
        '179야포대대_105mm견인포2중대':{
            'loc': [[265, 270], [190, 220]], 
            'comp': {
                "105mm_Howitzer": 2
                },
                'phase': 'P1-1'
        },
        '53전차대대_1중대':{
            'loc': [[100, 120], [330, 380]], 
            'dest': [[380, 400], [480, 510]],        
            'comp': {
                "Sho't_Kal":10
                },
            'phase': 'P2'
            }
    },
    'red':{
        # ===== P1-1 단계: 초기 교량 돌파 시도 =====
        '121기계화보병여단_전차중대': {
            'loc': [[620, 670], [300, 350]], 
            'dest': [[350, 400], [380, 420]],  # 중앙 돌파
            'comp': {
                "T-55": 10,
            },
        'phase': 'P1-1'
        },
        '85보병여단_1보병대대_1중대': {
            'loc': [[620, 670], [350, 370]], 
            'dest': [[400, 450], [420, 450]],  # 블루 주력 근처로 진격
            'comp':{
                "RPG-7":6,
                "107mm_B-11_Recoilless_Rifle":1
                },
            'phase': 'P1-1'
        },
        '85보병여단_2보병대대_4중대': {
            'loc': [[530, 580], [500, 520]], 
            'dest': [[450, 500], [350, 400]],  # 남쪽에서 우회 공격
            'comp': {
                "RPG-7":6,
                "107mm_B-11_Recoilless_Rifle":1
                },
                'phase': 'P1-1'
        },
        
        # ===== P2-1, P2-2 단계: 모로코 여단 주공격 =====
        '82기갑여단_5전차대대': {
            'loc': [[620, 670], [300, 350]], 
            'dest': [[300, 350], [440, 480]],  # 북쪽 우회 대규모 기갑 공격
            'comp': {
                "T-55":50,  
            },
            'phase': 'P2-1'
        },
        '82기갑여단_기보중대':  {
            'loc': [[620, 670], [280, 300]], 
            'dest': [[350, 400], [460, 500]],  # 기갑 지원
            'comp': {
                "BMP-1":10,
                "RPG-7": 10
                },
            'phase': 'P2-2'
        },
        
        # ===== P3 단계: 야간 기갑 동시 투입 =====
        '82기갑여단_6전차대대': {
            'loc': [[530, 580], [520, 550]], 
            'dest': [[250, 300], [280, 320]],  # 남쪽 측면 공격
            'comp': {
                "T-55":10
                },
            'phase': 'P3'
        },
        '78기갑여단_1전차대대': {
            'loc': [[530, 580], [550, 600]], 
            'dest': [[200, 250], [300, 350]],  # 남서쪽 깊숙이 침투
            'comp': {
                "T-55":40
                },
            'phase': 'P3'
        },
        
        # ===== P4 단계: 최종 예비 투입 =====
        '81기갑여단_7전차대대': {
            'loc': [[650, 700], [340, 400]], 
            'dest': [[150, 200], [250, 300]],  # 최후방 기습
            'comp': {
                "T-62":40,
            }, 
            'phase': 'P4'
        },
        '121기계화보병여단_3기보대대': {
            'loc': [[650, 700], [340, 430]], 
            'dest': [[200, 250], [400, 450]],  # 중앙 종심 돌파
            'comp': {
                "BMP-1": 40,
                "9M14_Malyutka": 3,
                "RPG-7": 40
                },
            'phase': 'P4'
        }
    }
}

# 전술적 설명
TACTICAL_CONCEPT = {
    'red_strategy': {
        'P1-1': "초기 교량 돌파 시도 - 소규모 보병/전차로 블루 방어선 테스트",
        'P2-1': "모로코 여단 주공격 - 북쪽으로 대규모 기갑부대 우회 진격", 
        'P2-2': "기계화보병 지원 - 주공격 지원 및 중앙 압박",
        'P3': "야간 동시 투입 - 남쪽 측면에서 2개 전차대대 동시 공격",
        'P4': "최종 예비 투입 - 깊숙한 후방 침투로 블루 붕괴 유도"
    },
    'blue_response': {
        'P1': "초기 방어 배치 - 주요 지점 고수",
        'P2': "예비 투입 - 53전차대대가 위기 지역 지원"
    }
}

# print("=== 레드팀 공격 계획 ===")
# for phase, description in TACTICAL_CONCEPT['red_strategy'].items():
#     print(f"{phase}: {description}")

# print("\n=== 블루팀 방어 계획 ===") 
# for phase, description in TACTICAL_CONCEPT['blue_response'].items():
#     print(f"{phase}: {description}")


# PLACEMENT = {
#     'blue': {  # 이스라엘 방어군 (제7기갑여단)
#         # ===== 1선 방어진지 =====
#         '77전차대대_A중대': {
#             'loc': [[385, 405], [350, 470]], 
#             'comp': {
#                 "Sho't_Kal": 12,
#             },
#             'phase': 'P1-1'
#         },
#         '77전차대대_B중대': {
#             'loc': [[360, 380], [380, 420]], 
#             'comp': {
#                 "Sho't_Kal": 11,
#             },
#             'phase': 'P1-1'
#         },
#         '75기계화보병대대_1중대': {
#             'loc': [[370, 390], [340, 370]], 
#             'comp': {
#                 "M113": 8,
#                 "M72_LAW": 4,
#                 "106mm_M40_Recoilless_Rifle": 2
#             },
#             'phase': 'P1-1'
#         },
        
#         # ===== 지원 화력 =====
#         '71포병대대_A포대': {
#             'loc': [[350, 370], [400, 430]], 
#             'comp': {
#                 "105mm_Howitzer": 6,
#             },
#             'phase': 'P1-1'
#         },
#         '71포병대대_박격포중대': {
#             'loc': [[355, 375], [420, 440]], 
#             'comp': {
#                 "60mm_Mortar": 6,
#             },
#             'phase': 'P1-1'
#         },
        
#         # ===== 2선 예비대 =====
#         '82전차대대_A중대': {
#             'loc': [[270, 290], [200, 250]], 
#             'comp': {
#                 "Sho't_Kal": 10,
#             },
#             'phase': 'P1-2'
#         },
#         '71포병대대_B포대': {
#             'loc': [[250, 270], [180, 210]], 
#             'comp': {
#                 "105mm_Howitzer": 4,
#             },
#             'phase': 'P1-2'
#         },
        
#         # ===== 반격예비대 =====
#         '79전차대대_전체': {
#             'loc': [[100, 140], [320, 380]], 
#             'dest': [[350, 400], [450, 500]],        
#             'comp': {
#                 "Sho't_Kal": 15,
#             },
#             'phase': 'P2'
#         },
        
#         # ===== 특수 지원부대 =====
#         '특수부대_대전차팀': {
#             'loc': [[380, 400], [300, 330]], 
#             'comp': {
#                 "BGM-71_TOW": 4,
#             },
#             'phase': 'P3'
#         },
#         '75기계화보병대대_2중대': {
#             'loc': [[320, 340], [280, 320]], 
#             'comp': {
#                 "M113": 6,
#                 "106mm_M40_Recoilless_Rifle": 4,
#                 "M72_LAW": 6
#             },
#             'phase': 'P2-2'
#         }
#     },
    
#     'red': {  # 시리아 공격군 (제5사단, 제9사단)
#         # ===== P1-1: 초기 정찰 공격 =====
#         '132기갑여단_정찰중대': {
#             'loc': [[620, 670], [400, 470]], 
#             'dest': [[380, 420], [380, 420]],
#             'comp': {
#                 "T-55": 8,
#                 "BMP-1": 3  # 정찰장갑차 역할
#             },
#             'phase': 'P1-1'
#         },
#         '61보병여단_1대대_A중대': {
#             'loc': [[640, 680], [380, 440]], 
#             'dest': [[400, 450], [410, 440]],
#             'comp': {
#                 "RPG-7": 8,
#                 "107mm_B-11_Recoilless_Rifle": 2,
#                 "AK-47": 15  # 보병 소총수
#             },
#             'phase': 'P1-1'
#         },
        
#         # ===== P1-2: 포병 준비사격 =====
#         '12포병여단_1대대': {
#             'loc': [[700, 750], [350, 500]], 
#             'comp': {
#                 "122mm_SPG": 18,  # 122mm + 130mm 통합
#             },
#             'phase': 'P1-2'
#         },
#         '12포병여단_로켓대대': {
#             'loc': [[720, 770], [300, 450]], 
#             'comp': {
#                 "BM-21_MLRS": 12,
#             },
#             'phase': 'P1-2'
#         },
        
#         # ===== P2-1: 1차 주공격 (북쪽 축선) =====
#         '132기갑여단_1전차대대': {
#             'loc': [[610, 660], [430, 480]], 
#             'dest': [[300, 350], [440, 480]],
#             'comp': {
#                 "T-55": 28,
#             },
#             'phase': 'P2-1'
#         },
#         '132기갑여단_기보대대_A중대': {
#             'loc': [[590, 640], [440, 490]], 
#             'dest': [[320, 370], [460, 500]],
#             'comp': {
#                 "BMP-1": 8,
#                 "RPG-7": 8
#             },
#             'phase': 'P2-1'
#         },
        
#         # ===== P2-2: 2차 주공격 (중앙 축선) =====
#         '78기갑여단_2전차대대': {
#             'loc': [[620, 670], [400, 450]], 
#             'dest': [[350, 400], [380, 420]],
#             'comp': {
#                 "T-55": 32,
#                 "T-62": 8
#             },
#             'phase': 'P2-2'
#         },
#         '61보병여단_2대대': {
#             'loc': [[640, 690], [380, 430]], 
#             'dest': [[380, 430], [400, 440]],
#             'comp': {
#                 "BMP-1": 12,
#                 "9M14_Malyutka": 3,
#                 "RPG-7": 12
#             },
#             'phase': 'P2-2'
#         },
        
#         # ===== P3: 야간 기습공격 (남쪽 우회) =====
#         '78기갑여단_3전차대대': {
#             'loc': [[650, 700], [340, 390]], 
#             'dest': [[250, 300], [280, 320]],
#             'comp': {
#                 "T-55": 24,
#                 "T-62": 6
#             },
#             'phase': 'P3'
#         },
#         '특수부대_공병중대': {
#             'loc': [[670, 720], [350, 400]], 
#             'dest': [[300, 350], [350, 400]],
#             'comp': {
#                 "T-55": 4,  # 공병 지원용 전차
#                 "BMP-1": 6,  # 공병 수송용
#                 "AK-47": 20  # 공병 보병
#             },
#             'phase': 'P3'
#         },
        
#         # ===== P4: 최종 돌파 시도 =====
#         '51기갑여단_예비대대': {
#             'loc': [[650, 700], [340, 400]], 
#             'dest': [[200, 250], [250, 300]],
#             'comp': {
#                 "T-62": 20,
#                 "T-55": 15
#             },
#             'phase': 'P4'
#         },
#         '132기갑여단_기보대대_잔여': {
#             'loc': [[650, 700], [340, 430]], 
#             'dest': [[200, 250], [400, 450]],
#             'comp': {
#                 "BMP-1": 18,
#                 "9M14_Malyutka": 4,
#                 "RPG-7": 18,
#                 "107mm_B-11_Recoilless_Rifle": 3
#             },
#             'phase': 'P4'
#         },
        
#         # ===== 보급 지원 =====
#         '후방보급대대': {
#             'loc': [[750, 780], [300, 500]], 
#             'comp': {
#                 "Red_Supply_Truck": 8,
#             },
#             'phase': 'P1-2'
#         }
#     }
# }